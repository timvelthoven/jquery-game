<html>
<head>
    <title>Friend or foe</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
<div class="intro-scroll">
    <div class="background-title">
        <div class="title"><img src="assets/img/logo.png"></div>
        <div class="layer-1"></div>
        <div class="layer-2"></div>
        <div class="layer-3"></div>
    </div>
    <div class="intro-text">
        <p id="intro-text-p">
        </p>

    </div>
</div>
<div id="game" class="game">
    <div class="kingdom">
        <div class="king"></div>
        <div class="floor"></div>
        <div class="chandeliers">
            <div class="chandelier"><img src="assets/img/chandelier.gif" alt=""/></div>
            <div class="chandelier"><img src="assets/img/chandelier.gif" alt=""/></div>
            <div class="chandelier"><img src="assets/img/chandelier.gif" alt=""/></div>
        </div>
    </div>

</div>
<script>
    $(".game").prepend("<div id='hero' class='in-kingdom'></div>");

    var hero_anchor = $('#hero').offset().top - screen.height;
    var intro_anchor = $('.intro-scroll').height() - screen.height + 100;
    var text_anchor = $('#intro-text-p').offset().top - screen.height;

    $(window).on('scroll.togame', function () {
        if ($(window).scrollTop() >= intro_anchor) {
            $(window).scrollTop(intro_anchor);
        }
    });

    $(window).on('scroll', function () {
        if ($(window).scrollTop() > hero_anchor)
            $('#hero.in-kingdom').addClass("walking");
    });

    $(window).on('scroll.text', function () {
        if ($(window).scrollTop() > text_anchor) {
            typeName(text, 0);
            $(window).off('scroll.text');
        }
    });

    
    $("a#yes").click(function () {
        $("html").css("scroll-behavior", "smooth");
        intro_anchor += intro_anchor
    });

    $('#hero').bind('animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd', function (e) {
        $(this).addClass("idle");
    });

    //////

    var text = "An evil enemy stole all the gold from your village... As a last resort, the king came to you, the retired village hero. He went all around the kingdom, but no fighter was as brave as you. Will you help him one last time?";

    function typeName(text, iteration) {
        if (iteration === text.length) {
            setTimeout(function () {
                $('#intro-text-p').append("<a id='yes' href='#game'><button>yes</button></a>");
                $('#intro-text-p').append("<button id='no' >no</button>");
            }, 10);
            return;
        }
        setTimeout(function () {
            $('#intro-text-p').text($('#intro-text-p').text() + text[iteration++]);
            typeName(text, iteration);
        }, 5);
    }
</script>
</body>
</html>